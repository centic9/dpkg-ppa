.\" dpkg manual page - dpkg-buildpackage(1)
.\"
.\" Copyright 息 1995-1996 Ian Jackson
.\" Copyright 息 2000 Wichert Akkerman <wakkerma@debian.org>
.\" Copyright 息 2007-2008 Frank Lichtenheld <djpig@debian.org>
.\" Copyright 息 2008-2013 Guillem Jover <guillem@debian.org>
.\" Copyright 息 2008-2012 Rapha谷l Hertzog <hertzog@debian.org>
.\"
.\" This is free software; you can redistribute it and/or modify
.\" it under the terms of the GNU General Public License as published by
.\" the Free Software Foundation; either version 2 of the License, or
.\" (at your option) any later version.
.\"
.\" This is distributed in the hope that it will be useful,
.\" but WITHOUT ANY WARRANTY; without even the implied warranty of
.\" MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
.\" GNU General Public License for more details.
.\"
.\" You should have received a copy of the GNU General Public License
.\" along with this program.  If not, see <https://www.gnu.org/licenses/>.
.
.\"*******************************************************************
.\"
.\" This file was generated with po4a. Translate the source file.
.\"
.\"*******************************************************************
.TH dpkg\-buildpackage 1 2013\-12\-12 "Debian Project" "dpkg ユーティリティ"
.SH 名前
dpkg\-buildpackage \- バイナリパッケージおよびソースパッケージのビルド
.
.SH 書式
\fBdpkg\-buildpackage\fP [\fIoption\fP...]
.
.SH 説明
\fBdpkg\-buildpackage\fP は、Debian パッケージのビルドを自動化するプログラムである。これには以下のステップが含まれる:
.IP \fB1.\fP 3
様々な環境変数 (\fB環境変数\fP を参照のこと) を定義することで、ビルド環境を設定し、\fBdpkg\-source \-\-before\-build\fP
を呼び出す (\fB\-T\fP もしくは \fB\-\-target\fPが指定されていない限り)。
.IP \fB2.\fP 3
ビルドにおける依存関係が満たされているか、競合が発生していないかをチェックする (\fB\-d\fP が指定されていない限り)。
.IP \fB3.\fP 3
\fB\-T\fP もしくは \fB\-\-target\fP
オプションにより、ビルドのターゲットが指定されている場合は、ターゲットを呼び出して、そこで実行を停止する。それ以外の場合は \fBfakeroot
debian/rules clean\fP を呼び出し、ビルドツリーをクリアする (\fB\-nc\fP が指定されていない限り)。
.IP \fB4.\fP 3
\fBdpkg\-source \-b\fP を呼び出し、ソースパッケージを生成する (\fB\-b\fP, \fB\-B\fP, \fB\-A\fP
によってバイナリパッケージのみのビルドが指定されていない限り)。
.IP \fB5.\fP 3
\fBfakeroot debian/rules\fP \fIbinary\-target\fP に続き、\fBdebian/rules\fP
\fBbuild\-target\fP を呼び出す (\fB\-S\fP によってソースパッケージのみのビルドが指定されていない限り)。\fIbuild\-target\fP
および \fIbinary\-target\fP は \fBbuild\fP および \fBbinary\fP (デフォルト、もしくは \fB\-b\fP
が指定されていた場合)、\fBbuild\-arch\fP および \fBbinary\-arch\fP (\fB\-B\fP
が指定されていた場合)、\fBbuild\-indep\fP および \fBbinary\-indep\fP (\fB\-A\fP が指定されていた場合)
のいずれかの値をとる。
.IP \fB6.\fP 3
It calls \fBgpg2\fP or \fBgpg\fP to sign the \fB.dsc\fP file (if any, unless \fB\-us\fP
is specified or on UNRELEASED builds).
.IP \fB7.\fP 3
\fBdpkg\-genchanges\fP を呼び出して、\fB.changes\fP ファイルを生成する。\fBdpkg\-buildpackage\fP
のオプションの多くが \fBdpkg\-genchanges\fP に引き継がれる。
.IP \fB8.\fP 3
It calls \fBgpg2\fP or \fBgpg\fP to sign the \fB.changes\fP file (unless \fB\-uc\fP is
specified or on UNRELEASED builds).
.IP \fB9.\fP 3
\fB\-tc\fP が指定されていた場合、\fBfakeroot debian/rules clean\fP が再度呼び出される。最後に \fBdpkg\-source
\-\-after\-build\fP が呼び出される。
.
.SH オプション
.TP 
\fB\-b\fP
バイナリパッケージのみのビルドを指定する。ソースファイルはビルドされず、配布もされない。オプションは \fBdpkg\-genchanges\fP に渡される。
.TP 
\fB\-B\fP
アーキテクチャ依存のパッケージについて、バイナリパッケージのみのビルドを指定する。オプションは \fBdpkg\-genchanges\fP に渡される。
.TP 
\fB\-A\fP
アーキテクチャ非依存のパッケージについて、バイナリパッケージのみのビルドを指定する。オプションは \fBdpkg\-genchanges\fP に渡される。
.TP 
\fB\-S\fP
ソースパッケージのみのビルドを指定する。バイナリパッケージは作成されない。オプションは \fBdpkg\-genchanges\fP に渡される。
.TP 
\fB\-F\fP
バイナリパッケージとソースパッケージの両方をビルドする、通常のフルビルドを指定する。これはビルドオプションを指定しなかった際のデフォルトの挙動である。
.TP 
\fB\-\-target=\fP\fItarget\fP
.TQ
\fB\-\-target \fP\fItarget\fP
.TQ
\fB\-T\fP\fItarget\fP
ビルド環境の設定後に、\fBdebian/rules\fP \fItarget\fP を呼び出し、そこでパッケージのビルド処理を中止する。\fB\-\-as\-root\fP
も設定されていた場合、コマンドは root として実行される (\fB\-r\fP も参照のこと)。Debian policy によって、公式に root
での実行が必須とされているターゲットについては、本オプションは不要である。
.TP 
\fB\-\-as\-root\fP
\fB\-\-target\fP と併せて指定された場合のみ有効であり、target の実行に root 権限が必要であることを指定する。
.TP 
\fB\-si\fP
.TQ
\fB\-sa\fP
.TQ
\fB\-sd\fP
.TQ
\fB\-v\fP\fIversion\fP
.TQ
\fB\-C\fP\fIchanges\-description\fP
.TQ
\fB\-m\fP\fImaintainer\-address\fP
.TQ
\fB\-e\fP\fImaintainer\-address\fP
\fBdpkg\-genchanges\fP にそのまま引き渡される。そちらのマニュアルページを参照のこと。
.TP 
\fB\-a\fP\fIarchitecture\fP
ビルド対象となる Debian アーキテクチャを指定する。ビルドを実行するマシンのアーキテクチャは自動的に判別され、ホストマシンのデフォルト値となる。
.TP 
\fB\-t\fP\fIgnu\-system\-type\fP
ビルド対象となる GNU システムタイプを指定する。これは \-a オプションの代わりとしてターゲットの Debian
アーキテクチャに対応するデフォルトの GNU システムタイプを上書きするために用いられる。
.TP 
\fB\-P\fP\fIprofile\fP[\fB,\fP...]
Specify the profile(s) we build, as a comma\-separated list, without the
"\fBprofile.\fP" namespace prefix. The default behavior is to build for no
specific profile. Also adds them (as a space separated list) to the
\fBDEB_BUILD_PROFILES\fP environment variable which allows, for example,
\fBdebian/rules\fP files to use this information for conditional builds.
.TP 
\fB\-j\fP\fIjobs\fP
Number of jobs allowed to be run simultaneously, equivalent to the
\fBmake\fP(1)  option of the same name. Will add itself to the \fBMAKEFLAGS\fP
environment variable, which should cause all subsequent make invocations to
inherit the option. Also adds \fBparallel=\fP\fIjobs\fP to the
\fBDEB_BUILD_OPTIONS\fP environment variable which allows debian/rules files to
use this information for their own purposes.  The \fBparallel=\fP\fIjobs\fP in
\fBDEB_BUILD_OPTIONS\fP environment variable will override the \fB\-j\fP value if
this option is given.
.TP 
\fB\-D\fP
ビルドの依存関係と競合をチェックし、問題がある場合は処理を中断させる。これはデフォルトの挙動である。
.TP 
\fB\-d\fP
ビルドの依存関係と競合をチェックしない。
.TP 
\fB\-nc\fP
ソースツリーを消去しない (\fB\-B\fP, \fB\-A\fP, \fB\-S\fP いずれもが指定されない場合は、\fB\-b\fP が指定されたと見なされる)。
.TP 
\fB\-tc\fP
パッケージのビルド後にソースツリーを消去する (\fIgain\-root\-command\fP \fBdebian/rules clean\fP が用いられる)。
.TP 
\fB\-r\fP\fIgain\-root\-command\fP
\fBdpkg\-buildpackage\fP がビルド処理の一部を root
権限で実行する必要がある場合、このオプションが指定されていれば、実行するコマンドの前に \fIgain\-root\-command\fP
が付けられる。このオプションが指定されていなかった場合は、\fBfakeroot\fP
が存在していれば、それがデフォルトで用いられる。\fIgain\-root\-command\fP は\fBPATH\fP
上のプログラム名である必要があり、実際に実行したいコマンドに続き、そのコマンドの引数を引数として指定する。\fIgain\-root\-command\fP には
(スペースで区切られた) パラメータを含めてもよいが、シェルのメタキャラクタを含めることはできない。\fIgain\-root\-command\fP は通常
\fBfakeroot\fP, \fBsudo\fP, \fBsuper\fP, \fBreally\fP などである。\fBsu\fP
は、実行したいコマンドに引数を個々に引き渡すのではなく、\fB\-c\fP を用いてユーザのシェルを起動するだけであるため適切ではない。
.TP 
\fB\-R\fP\fIrules\-file\fP
Debian パッケージのビルドの際は、通常 \fBdebian/rules\fP
コマンドが幾つかの標準的な引数を付けて実行される。このオプションにより、パッケージのビルドの際に別のプログラムを使用することが可能となる
(スペースで区切られた引数を含めることも可能である)。標準のルールファイルを別の make プログラムで実行する (例えば \fIrules\-file\fP
の代わりに \fB/usr/local/bin/make \-f debian/rules\fP を使用する) ために使用することもできる。
.TP 
\fB\-p\fP\fIsign\-command\fP
When \fBdpkg\-buildpackage\fP needs to execute GPG to sign a source control
(\fB.dsc\fP) file or a \fB.changes\fP file it will run \fIsign\-command\fP (searching
the \fBPATH\fP if necessary) instead of \fBgpg2\fP or \fBgpg\fP. \fIsign\-command\fP will
get all the arguments that \fBgpg2\fP or \fBgpg\fP would have
gotten. \fIsign\-command\fP should not contain spaces or any other shell
metacharacters.
.TP 
\fB\-k\fP\fIkey\-id\fP
パッケージに署名する際に使用する鍵のIDを指定する。
.TP 
\fB\-us\fP
ソースパッケージに署名しない。
.TP 
\fB\-uc\fP
\&\fB.changes\fP ファイルに署名しない。
.TP 
\fB\-\-force\-sign\fP
Force the signing of the resulting files (since dpkg 1.17.0), regardless of
\fB\-us\fP or \fB\-uc\fP or other internal heuristics.
.TP 
\fB\-i\fP[\fIregex\fP]
.TQ
\fB\-I\fP[\fIpattern\fP]
.TQ
\fB\-s\fP[\fBnsAkurKUR\fP]
.TQ
\fB\-z\fP, \fB\-Z\fP
\fBdpkg\-source\fP にそのまま引き渡される。そちらのマニュアルページを参照のこと。
.TP 
\fB\-\-source\-option=\fP\fIopt\fP
\fBdpkg\-source\fP に \fIopt\fP オプションを引き渡す。
.TP 
\fB\-\-changes\-option=\fP\fIopt\fP
\fBdpkg\-genchanges\fP に \fIopt\fP オプションを引き渡す。
.TP 
\fB\-\-admindir=\fP\fIdir\fP
.TQ
\fB\-\-admindir \fP\fIdir\fP
\fBdpkg\fP データベースの位置を変更する。デフォルトの位置は \fI/var/lib/dpkg\fP である。
.TP 
\fB\-?\fP, \fB\-\-help\fP
利用方法を表示して終了する。
.TP 
\fB\-\-version\fP
バージョン情報を表示して終了する。
.
.SH 環境変数
.TP 
\fBDEB_SIGN_KEYID\fP
If set, it will be used to sign the \fB.changes\fP and \fB.dsc\fP files.
Overridden by the \fB\-k\fP option.
.TP 
\fBDEB_BUILD_PROFILES\fP
If set, it will be used as the active build profile(s) for the package being
built. It is a space separated list of profile names, without the
"\fBprofile.\fP" namespace prefix. Overridden by the \fB\-P\fP option.

.SS "Reliance on exported environment flags"
\fBdpkg\-buildpackage\fP が幾つかの変数をエクスポートしていたとしても、\fBdebian/rules\fP
はその存在に依存してはならない。代わりに必要な値を取得するためのインタフェースを使用すること。
.SS "dpkg\-architecture によって設定される変数"
\fBdpkg\-architecture\fP は \fB\-a\fP および \fB\-t\fP を引数として呼び出される。このコマンドの \fB\-s\fP
オプションによって設定された変数はビルド環境にマージされる。
.
.SH 参考
.SS コンパイラフラグのエクスポート停止
Between dpkg 1.14.17 and 1.16.1, \fBdpkg\-buildpackage\fP exported compiler
flags (\fBCFLAGS\fP, \fBCXXFLAGS\fP, \fBFFLAGS\fP, \fBCPPFLAGS\fP and \fBLDFLAGS\fP) with
values as returned by \fBdpkg\-buildflags\fP. This is no longer the case.
.SS "Default build targets"
\fBdpkg\-buildpackage\fP is using the \fBbuild\-arch\fP and \fBbuild\-indep\fP targets
since dpkg 1.16.2. Those targets are thus mandatory. But to avoid breakages
of existing packages, and ease the transition, it will fallback to using the
\fBbuild\fP target if \fBmake \-f debian/rules \-qn\fP \fIbuild\-target\fP returns 2 as
exit code.
.SH バグ
\fIgain\-root\-command\fP および \fIsign\-command\fP
の先頭の引数として、スペースやシェルのメタキャラクタを指定できるようにすべきである。
.
.SH 関連項目
.ad l
.nh
\fBdpkg\-source\fP(1), \fBdpkg\-architecture\fP(1), \fBdpkg\-buildflags\fP(1),
\fBdpkg\-genchanges\fP(1), \fBfakeroot\fP(1), \fBgpg2\fP(1), \fBgpg\fP(1).
.SH 翻訳者
高橋 基信 <monyo@monyo.com>.
喜瀬 浩 <kise@fuyuneko.jp>.
関戸 幸一 <sekido@mbox.kyoto-inet.or.jp>.
鍋谷 栄展 <nabe@debian.or.jp>.
倉澤 望 <nabetaro@debian.or.jp>.
石川 睦 <ishikawa@linux.or.jp>.
鵜飼 文敏 <ukai@debian.or.jp>.
中野 武雄 <nakano@apm.seikei.ac.jp>.
.SH 翻訳校正
Debian JP Documentation ML <debian-doc@debian.or.jp>.
